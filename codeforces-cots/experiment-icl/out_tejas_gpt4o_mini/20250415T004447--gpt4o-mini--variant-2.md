To solve the problem of how many hours Vasily can keep his candles burning, we can break down the process into a series of steps. The key is to understand how to optimally use the candles and the stubs left after burning them.

### Problem Breakdown

1. **Initial Candles**: Vasily starts with `a` candles, which means he can burn them for `a` hours.
2. **Stubs Creation**: After burning the `a` candles, he will have `a` stubs (one for each candle).
3. **Recycling Stubs**: For every `b` stubs, Vasily can create one new candle. This means that the number of new candles he can create from the stubs is `a // b`.
4. **Repeat the Process**: Each new candle can be burned for an hour, and it will produce another stub. The leftover stubs after creating new candles will be `a % b`. This process continues until there are not enough stubs to create a new candle.

### Steps to Calculate Total Hours

1. Start with the initial number of candles `a`.
2. Initialize a variable to keep track of the total hours.
3. While there are enough stubs to create at least one new candle:
   - Calculate how many new candles can be created from the current stubs.
   - Add the number of new candles to the total hours.
   - Update the number of stubs to include the leftover stubs plus the new stubs from the newly created candles.
4. Stop when the number of stubs is less than `b`.

### Implementation

The implementation will follow the outlined steps, ensuring efficiency given the constraints (up to 1,000,000 candles and stubs). The algorithm will run in logarithmic time relative to the number of candles due to the recycling process.

Here's the complete implementation in Python:

```python
def main():
    import sys
    input = sys.stdin.read
    data = input().splitlines()
    
    t = int(data[0])  # Number of test cases
    results = []
    
    for i in range(1, t + 1):
        a, b = map(int, data[i].split())
        
        total_hours = a  # Start with the initial candles
        stubs = a  # All initial candles become stubs
        
        while stubs >= b:
            new_candles = stubs // b  # Create new candles from stubs
            total_hours += new_candles  # Add the hours from new candles
            stubs = new_candles + (stubs % b)  # Update stubs: new candles + leftover stubs
        
        results.append(total_hours)
    
    print("\n".join(map(str, results)))

if __name__ == "__main__":
    main()
```

### Explanation of the Code

1. **Input Handling**: The code reads all input at once for efficiency, especially since there can be up to 10,000 test cases.
2. **Loop Through Test Cases**: For each test case, it initializes the total hours with the number of initial candles.
3. **While Loop**: It continues to create new candles from stubs until there are not enough stubs left to create a new candle.
4. **Output**: Finally, it prints the total hours for each test case.

### Complexity Analysis

- **Time Complexity**: The while loop runs logarithmically with respect to the number of candles because each iteration reduces the number of stubs significantly. Thus, the overall complexity is O(t * log(a)), where `t` is the number of test cases.
- **Space Complexity**: The space used is O(t) for storing results, which is efficient given the constraints.

This approach ensures that we efficiently calculate the maximum hours Vasily can keep his candles burning while adhering to the problem's constraints.
