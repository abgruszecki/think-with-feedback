<think>
Okay, let's tackle this problem. Hmm. So the problem is about finding all possible fun values for different k values when passing the ball around a circle of n people. The fun value is the sum of all unique people who touched the ball until it returns to person 1. 

First, I need to understand how the passing works. For a given k, each step moves k places forward. But since the people are in a circle, it's effectively moving (current position + k -1) mod n, but maybe I should model it as (current + k) mod n, but adjusted for 1-based indexing. Wait, let's see. For example, when n=6 and k=4, starting at 1, the next is 1+4=5. Then from 5, adding 4 gives 9 mod 6 is 3. Then from 3, adding 4 is 7 mod6 is 1 again. So the sequence is 1,5,3,1. So the fun value is sum of 1+5+3=9. 

So the process is that each step adds k, mod n. But since the people are in a circle of size n, each step moves k steps ahead. Wait, but in modular arithmetic terms, moving k steps in a circle of n is equivalent to (current + k) mod n. But since the numbering starts from 1, perhaps the actual calculation is (current + k -1) mod n +1. Because for example, current is 1 (position 0 in 0-based), adding k steps would be 0 +k mod 6. Then convert back to 1-based. So for k=4, 0+4 mod6 is 4, which is 5 in 1-based. Then 4+4=8 mod6=2, which is 3 in 1-based. Then 2+4=6 mod6=0, which is 1. So that's correct.

So the sequence of positions is determined by starting at 1 (0 in 0-based) and each step adding k (mod n). But since the positions are 1-based, perhaps it's easier to model in 0-based. So let's model the current position as x (0-based), and each step is (x +k) mod n. Then convert back to 1-based when needed.

But the key here is that the ball moves in steps of k, and the process stops when it returns to 1. So the cycle is the path taken until it returns to 1. The fun value is the sum of all distinct people in this cycle.

Wait, but the cycle must form a loop. So for a given k, the ball starts at 1, and each step is adding k mod n. So the path is the same as the steps generated by (1, 1 +k, 1 +2k, ...) mod n. But when does it return to 1? That's when the steps have cycled.

The problem says that for any positive integer k (up to n), the ball will return to 1 after some steps. So the set of steps forms a cycle that starts and ends at 1.

The fun value is the sum of all the unique people in this cycle. So for each k, the sum is the sum of all distinct nodes visited in this cycle.

Our task is to collect all possible such sums for all possible k (from 1 to n), and output them in sorted order.

But n can be up to 1e9, so we can't iterate through all k from 1 to n. We need a mathematical approach to find all possible fun values efficiently.

Let me think about the possible cycles. For each k, the ball's path is determined by the additive steps modulo n. The path forms a cycle that includes 1, and the sum is the sum of all elements in the cycle (excluding the last 1, since we stop when it comes back). Wait, but in the example given, the path is [1,5,3,1], and the sum is 1+5+3=9. So the last 1 is not counted again.

So each cycle for a k is the set of nodes visited until it returns to 1, but the return to 1 is the end. So the nodes in the cycle are all the nodes except the last 1. So the sum is the sum of the nodes in the cycle up to but not including the last 1.

So the problem reduces to finding for each possible k, the sum of the cycle generated by starting at 1 and adding k each time mod n, until it returns to 1. Then collect all possible sums.

But with n up to 1e9, we need a smarter approach.

Let's model the problem in terms of modular arithmetic. Let's work in 0-based indices for easier math. So the starting position is 0 (which is 1 in 1-based). Each step adds k (mod n). The cycle ends when we return to 0. The number of steps taken is the length of the cycle (including the return to 0), but the sum includes all elements except the last 0. So the sum is the sum of all elements visited in the cycle except the last 0.

Alternatively, the cycle length is the minimal t such that t*k â‰¡0 mod n. Because after t steps, we have 0 + t*k â‰¡0 mod n. So the minimal t is n / gcd(k, n). Wait, because the additive step is k each time. The cycle length is the order of k modulo n. The additive order of k mod n is the minimal t such that t*k â‰¡0 mod n. So yes, t = n / gcd(k, n). Because t must be such that k * t is a multiple of n. The minimal t is n / (k's gcd with n). 

So for each k, the cycle length is t = n / g, where g = gcd(k, n). Then, the cycle will consist of t steps. The positions visited are 0, k, 2k, ..., (t-1)k mod n. Then, after t steps, we return to 0. So the sum is the sum of all these positions (converted to 1-based) except the last 0.

So the sum S for a particular k is sum_{i=0}^{t-1} ( (i*k mod n) + 1 ) = sum_{i=0}^{t-1} (i*k mod n) + t.

But the sum of (i*k mod n) for i from 0 to t-1. Let's compute that.

Since t = n/gcd(k,n), let's denote g = gcd(k, n). Let's set d = g. Then, k = d * k', n = d * n', and gcd(k', n') =1. Then t = n/d = n'. 

So the step is k = d*k', which modulo d*n' is equivalent to d*(k' mod n'). Since k' and n' are coprime, the terms (i*k mod n) for i from 0 to t-1 will form an arithmetic sequence with step k, but modulo n. However, since the steps are d*k' in a modulus of d*n', the residues are 0, d*k', 2d*k', ..., (n'-1)d*k' mod d*n'. 

But since k' and n' are coprime, multiplying by k' mod n' is a permutation. So the residues will be 0, d*1, d*2, ..., d*(n'-1) mod d*n'. Wait, no. Wait, let me see. Let's say we have i varying from 0 to n' -1. Then, (i * d*k') mod (d*n') = d*(i*k' mod n'). Since k' and n' are coprime, i*k' mod n' cycles through all residues 0, 1, ..., n'-1 as i varies. So the residues mod d*n' are d*0, d*1, ..., d*(n'-1). 

Therefore, the sum of (i*k mod n) for i from 0 to t-1 (t =n') is sum_{i=0}^{n'-1} d * i. Because each term is d*i. 

So sum is d * (n' -1)*n' / 2. 

Then, the total sum S for k is (d * (n' -1)*n' /2) + t, where t =n'.

But t is n' = n/d. So substituting:

sum = d * ( (n/d -1) * (n/d) ) / 2 ) + (n/d).

So simplifying, sum = (d * (n/d) * (n/d -1)) ) / 2 + n/d.

Which is (n * (n/d -1)) ) / 2 + n/d.

But n is d * n', so n/d is n'. 

Wait, n' = n/d. So sum = d * (n' * (n' -1)) / 2 + n' = (d * n' (n' -1) ) / 2 + n'.

But d is the gcd(k, n). So for each k, the sum S depends only on d = gcd(k, n). Because different k's with the same d will generate the same sum. 

Therefore, for each possible d (divisor of n), we can compute the sum S as a function of d, and collect all unique S values. 

Wait, that's a key insight. Because two different k's that have the same gcd with n will generate the same sum. So instead of iterating all possible k from 1 to n, we can iterate over all possible divisors d of n. For each d, the sum S can be computed based on d. Then, the set of all possible S's is the set of S for all possible divisors d of n. 

Wait, but wait. Let's verify this. For example, in the first sample input n=6. The divisors of 6 are 1,2,3,6. Let's see for each d:

Take d=1. Then, n' =6/1=6. sum is (1 *6*(6-1)/2 ) +6 = (30/2)+6=15+6=21. Which matches the sample where k=1 (d=1) gives sum 21.

d=2: n'=6/2=3. sum is 2*3*(3-1)/2 +3 = (2*3*2/2)+3=6 +3=9. Which is the sample's case for k=4 (which has gcd(4,6)=2). 

d=3: n'=6/3=2. sum is 3*2*(2-1)/2 +2 = (3*2*1/2)+2=3+2=5. Which matches the sample's case for k=3 (gcd 3), and k=2 (gcd 2). Wait, no. Wait, for k=2, gcd(2,6)=2, which would be d=2. So for d=2, sum is 9, which in the sample is for k=2 and k=4. 

Then for d=6: n'=6/6=1. sum is 6*1*0/2 +1 =0 +1=1. Which is the sample's case for k=6 (sum 1).

So the possible d's are the divisors of n. And for each divisor d, we can compute the sum S. Then, the set of all S's is the required answer. 

Therefore, the steps to solve the problem are:

1. Find all divisors d of n. But since n can be up to 1e9, we need an efficient way to find all divisors. 

2. For each divisor d, compute the sum S using the formula derived earlier. 

3. Collect all unique S's, sort them, and output them in order. 

So the problem reduces to factorizing n and finding all its divisors. Then for each divisor d (including 1 and n), compute S(d) and collect the unique values. 

But wait, the sample input 6 has output 1,5,9,21. The divisors of 6 are 1,2,3,6. So the sum for each d is 21 (d=1), 9 (d=2),5 (d=3), 1 (d=6). Which are exactly the output values. So the sample's output is the sorted S values for all divisors. 

So the conclusion is that the possible fun values are exactly the S(d) for each divisor d of n. 

Therefore, the problem's solution is to:

- Find all divisors of n.

- For each divisor d, compute S(d) = (d * ( (n/d) * (n/d -1) ) // 2 ) + (n/d).

Wait, no. Wait, the formula we derived earlier is:

sum = (d * (n' * (n' -1)) ) / 2 + n', where n' =n/d. 

So substituting n' =n/d:

sum = d * (n/d) * (n/d -1) / 2 + (n/d).

Simplify the first term: d * (n/d) =n. So sum = n*(n/d -1)/2 + (n/d). 

Wait, that's a different expression. Let me recheck:

sum = (d * (n' * (n' -1)) ) / 2 + n'

But n' =n/d. So:

sum = d * ( (n/d) * (n/d -1) ) / 2 + (n/d)

= (n (n/d -1 )) / 2 * (d * (n/d) * (n/d -1 )) / 2 ?

Wait, perhaps it's better to write as:

sum = (d * (n/d) * (n/d -1 )) // 2 + (n/d).

But d * (n/d) =n. So sum can be written as (n*(n/d -1) ) //2 + (n/d). 

So sum = (n * ( (n/d) -1 )) // 2 + (n/d). 

Let's compute this for each divisor d:

For d=1 (sample n=6):

sum = 6*(6/1 -1 )//2 +6/1 =6*5//2 +6= 30/2 +6=15+6=21. Correct.

For d=2 (n=6):

sum=6*(3-1)/2 +3=6*2/2+3=6+3=9. Correct.

d=3:

sum=6*(2-1)/2 +2=6*1/2+2=3+2=5. Correct.

d=6:

sum=6*(1-1)/2 +1=0+1=1. Correct.

Yes, so the formula works. So the sum for a divisor d is:

S = (n * ( (n/d) -1 )) // 2 + (n/d)

Simplify that:

S = [n*( (n/d -1) ) /2 ] + (n/d)

But n is divisible by d, since d is a divisor. So n/d is an integer. 

So the formula can be rewritten as:

S = (n * (m - 1) ) // 2 + m, where m = n/d.

But m is n/d, and d is a divisor. So for each divisor d, m is a divisor of n, but in reverse. Wait, no. Because m =n/d. So for each divisor d of n, m is also a divisor. So when we iterate through all d's divisors, m will be all divisors of n. 

Wait, but perhaps m is another way. For example, the divisors of 6 are 1,2,3,6. For each d in divisors, m is 6,3,2,1. So m's are the same as the divisors but in reverse order. So S can be expressed in terms of m, which is a divisor of n. 

So S = (n * (m-1) ) //2 + m, where m is a divisor of n. 

This might be a useful way to compute it. Because for each m (divisor of n), we can compute S as (n*(m-1)/2) +m. 

So for example, m=6 (divisor of 6):

S= (6*(6-1)/2 ) +6 = (6*5/2)+6=15+6=21. Which is for d=1.

Similarly, m=3: (6*2/2)+3=6+3=9. Which is for d=2.

So the sum S is the same as if m is a divisor of n, and S is computed as (n*(m-1)/2) +m. 

This suggests that for each divisor m of n, the sum S is (n*(m-1)/2) +m. 

But wait, m is n/d, so when d is a divisor, m is also a divisor. So the set of all possible S's is the same as the set generated by all divisors m of n, calculated as (n*(m-1)/2) +m. 

Thus, the steps are:

- Find all divisors of n, including 1 and n.

- For each divisor m, compute S = (n*(m-1)//2) +m.

- Collect all these S's, sort them, and output.

Wait, but in the previous example, for n=6, the divisors m are 1,2,3,6. Then the S's would be:

m=1: (6*0)/2 +1=0+1=1.

m=2: (6*1)/2 +2=3+2=5.

m=3: (6*2)/2 +3=6+3=9.

m=6: (6*5)/2 +6=15+6=21.

Which are exactly the sorted outputs in the first sample: 1,5,9,21. Which matches. 

Similarly, in the second sample input 16:

The divisors of 16 are 1,2,4,8,16. 

For each m in these divisors:

m=1: (16*0)/2 +1=1.

m=2: (16*1)/2 +2=8+2=10.

m=4: (16*3)/2 +4=24 +4=28.

m=8: (16*7)/2 +8=56+8=64.

m=16: (16*15)/2 +16=120+16=136.

Which matches the sample output: 1 10 28 64 136. 

So this confirms that the correct approach is to generate all divisors m of n, compute S(m) = (n*(m-1)//2) +m, collect all S's, sort them, and output.

Thus, the problem reduces to:

1. Generate all divisors of n. 

2. For each divisor m, compute S = (n*(m-1)//2) +m.

3. Collect all S's, sort them, and output.

Now, the key steps are:

- Factorizing n into its prime factors.

- Generating all divisors from the prime factors.

- Computing S for each divisor m.

But n can be up to 1e9. Factorizing 1e9 can be done efficiently with trial division up to sqrt(n), which for 1e9 is 31622. That's manageable.

Once we have the factors, generating all divisors is straightforward.

So the plan is:

Implement a function to factorize n into its prime factors, then generate all divisors from the factors. Then compute S for each divisor, collect into a set (to avoid duplicates, although in this problem, each m gives a unique S?), sort, then output.

Wait, but can different divisors m1 and m2 give the same S? For example, n=4. Divisors are 1,2,4.

m=1: S= (4*0)/2 +1=1.

m=2: (4*1)/2 +2=2+2=4.

m=4: (4*3)/2 +4=6+4=10. So outputs are 1,4,10. All unique.

Another example: n=9. Divisors are 1,3,9.

m=1: (9*0)/2 +1=1.

m=3: (9*2)/2 +3=9+3=12.

m=9: (9*8)/2 +9=36 +9=45. So outputs 1,12,45. All unique.

So perhaps all S(m) are unique for different m's. Let me check for a case where that might not be the case.

Suppose n=5. Divisors are 1,5.

m=1: 0 +1=1.

m=5: (5*4)/2 +5=10+5=15. So outputs 1,15. 

Another example: n=8. Divisors 1,2,4,8.

m=1:1.

m=2: (8*1)/2 +2=4+2=6.

m=4: (8*3)/2 +4=12+4=16.

m=8: (8*7)/2 +8=28+8=36. So outputs 1,6,16,36.

No duplicates. 

Another example: n=12.

Divisors are 1,2,3,4,6,12.

Compute S for each m:

m=1:1.

m=2: (12*1)/2 +2=6+2=8.

m=3: (12*2)/2 +3=12+3=15.

m=4: (12*3)/2 +4=18+4=22.

m=6: (12*5)/2 +6=30+6=36.

m=12: (12*11)/2 +12=66+12=78.

So the outputs are 1,8,15,22,36,78. All unique.

So perhaps all divisors m of n give distinct S values. So we can collect all S's for all divisors, sort them, and output. No need to deduplicate. But why?

Because for each m, the function S(m) is strictly increasing as m increases. Let's check:

S(m) = (n(m-1)/2) +m = (n(m-1) +2m)/2 = (n(m-1) +2m)/2.

Is this function increasing with m?

Take derivative with respect to m: (n +2)/2. Since n is at least 2, this is positive. So as m increases, S(m) increases. Therefore, all S(m) are distinct for different m's, and m must be in sorted order, so the S(m) are in sorted order.

Wait, but m is the divisor of n, and they can be in any order. But when we sort the divisors of n in increasing order, the S(m) will be in increasing order. For example, n=6: m's sorted as 1,2,3,6. S's are 1,5,9,21, which are increasing. For n=16, m's sorted as 1,2,4,8,16. S's are 1,10,28,64,136, which are increasing. So the S's are in the same order as the m's when sorted. Therefore, if we collect all m's (divisors of n) in sorted order, compute S(m) for each, and collect the S's, they will be in sorted order. 

Wait, no. Let's see for m=3 in n=6, S=5. Then for m=2, S=9? No, wait in the first sample, the sorted m's are 1,2,3,6, and the S's are 1,5,9,21. So 5<9, which is correct. So the S's are increasing as m increases. Because S(m) is a function of m, and the function is linear with a positive coefficient (since derivative is (n+2)/2 which is positive). So m1 < m2 implies S(m1) < S(m2). Therefore, when we collect all m's (divisors) in sorted order, compute S(m), the S's are in sorted order. 

Therefore, the steps are:

1. Find all divisors of n.

2. Sort them in increasing order.

3. For each m in this sorted list, compute S(m) = (n*(m-1)//2) + m.

4. Collect all S(m) into the output list, which is already sorted.

Therefore, the code can be structured as:

- Generate the sorted list of divisors of n.

- For each divisor m in sorted order, compute S and collect them.

- Output the collected S's separated by spaces.

Now, the key steps are factorizing n and generating the sorted list of divisors.

But factorizing n can be done via trial division. Let's outline the code steps.

First, code to find all divisors of n:

def get_divisors(n):

    divisors = set()

    i = 1

    while i*i <=n:

        if n%i ==0:

            divisors.add(i)

            divisors.add(n//i)

        i +=1

    return sorted(divisors)

But for n up to 1e9, this is manageable, as the loop runs up to sqrt(n), which is 3e4 for 1e9.

Wait, 31622 for 1e9. So even 3e4 iterations is manageable. So trial division is feasible here.

Once we have all divisors, we sort them. Then compute S for each.

But in Python, even for n=1e9, this code should work quickly.

So now, the code steps are:

Read n.

Compute all divisors of n, sorted.

For each m in the sorted divisors:

    s = (n*(m-1)) //2 + m

Collect all s's, and output them space-separated.

But wait, in the first sample, when m=1, s is 1. But in the sample, the output is 1 5 9 21, which is the sorted list.

Yes, because the divisors of 6 are [1,2,3,6], sorted. For each m in this order, compute s:

m=1: (6*0)//2 +1 =0 +1=1

m=2: (6*1)//2 +2=3+2=5

m=3: (6*2)//2 +3=6+3=9

m=6: (6*5)//2 +6=15+6=21

So output is 1 5 9 21.

Which matches the sample.

Similarly, for n=16, divisors sorted are [1,2,4,8,16], which gives the sample output.

Thus, the code is correct.

Now, edge cases. Let's test n=2.

Divisors are 1,2.

For m=1: (2*0)/2 +1=1.

m=2: (2*1)/2 +2=1+2=3.

Output is 1 3.

Another edge case: n= prime, say 5.

Divisors are 1,5.

Output is 1 and (5*4//2 +5=10+5=15). So 1 15.

Another case: n=4. Divisors are 1,2,4.

S values:

1: 1.

2: (4*1)/2 +2=2+2=4.

4: (4*3)/2 +4=6+4=10.

So output 1 4 10.

Which is correct.

Thus, the code works.

So the code is:

Read n.

Generate all divisors, sorted.

For each m in divisors, compute s.

Print the s's separated by space.

Now, implement this in Python.

But generating the divisors can be done via trial division. Let's code that.

But in Python, for n=1e9, the trial division loop is up to sqrt(n) =3e4, which is manageable.

But for a more efficient code, perhaps handle even numbers first.

But for the problem constraints, trial division is acceptable.

So the code:

Read n from input.

Generate all divisors.

Sort them.

Compute s for each.

Output.

Now, code:

Testing against sample input 1.

```python
def main(input_stream, output_stream):
    n = int(input_stream.readline().rstrip("\n"))

    def get_divisors(n):

        divisors = set()

        i = 1

        while i*i <=n:

            if n%i ==0:

                divisors.add(i)

                divisors.add(n//i)

            i +=1

        return sorted(divisors)

    divisors = get_divisors(n)

    result = [ (n * (m-1) // 2) + m for m in divisors ]

    print(' '.join(map(str, result)), file=output_stream)



def test():
    import io

    TEST_CASES = [
        {
            "input": \
"""\
16
""",
            "output": \
"""\
1 10 28 64 136
""",
        }, 
    ]

    for i, test_case in enumerate(TEST_CASES):
        in_stream = io.StringIO(test_case["input"])
        expected_output = test_case["output"].rstrip()

        out_stream = io.StringIO()
        main(in_stream, out_stream)
        real_output = out_stream.getvalue().rstrip()

        assert real_output == expected_output, \
            f'Test case {i} failed.\nExpected: {expected_output!r}\nGot: {real_output!r}'

    print('Tests passed ðŸ˜Ž')


if __name__ == '__main__':
    test()


```

<RUN_SNIPPET>
```output
Tests passed ðŸ˜Ž

```

Yes, this should work.

But what about when n is a square, like 4. Divisors are 1,2,4. The code adds 1,2,4. Correct.

But wait, in the code, the loop is i from 1 to sqrt(n). For i=2, when n=4, i*i=4, which is equal to n. So 4%2=0. So divisors.add(2) and divisors.add(4/2=2). So the set has 1,2,4. Correct.

Thus, the code is correct.
</think>

```python
n = int(input())

def get_divisors(n):
    divisors = set()
    i = 1
    while i * i <= n:
        if n % i == 0:
            divisors.add(i)
            divisors.add(n // i)
        i += 1
    return sorted(divisors)

divisors = get_divisors(n)
result = [(n * (m - 1) // 2) + m for m in divisors]
print(' '.join(map(str, result)))
```
